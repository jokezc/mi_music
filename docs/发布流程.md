# å‘å¸ƒæµç¨‹æ–‡æ¡£

æœ¬æ–‡æ¡£æè¿°äº†å¦‚ä½•ä¸ºé¡¹ç›®æ‰“ tagã€æ‰“åŒ…ã€ä¿®å¤ç‰ˆæœ¬å·å¹¶å‘å¸ƒåˆ° GitHub çš„å®Œæ•´æµç¨‹ã€‚

## ğŸ“‹ å‰ç½®å‡†å¤‡

åœ¨å¼€å§‹å‘å¸ƒæµç¨‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ï¼š

1. âœ… æ‰€æœ‰ä»£ç å·²æäº¤åˆ°æœ¬åœ°ä»“åº“
2. âœ… ä»£ç å·²æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼ˆ`git push`ï¼‰
3. âœ… å·²é€šè¿‡æ‰€æœ‰æµ‹è¯•å’Œä»£ç æ£€æŸ¥
4. âœ… å·²æ›´æ–° CHANGELOG.mdï¼ˆå¦‚é€‚ç”¨ï¼‰

## ğŸš€ å‘å¸ƒæ­¥éª¤

### 1. æ›´æ–°ç‰ˆæœ¬å·

ç‰ˆæœ¬å·æ ¼å¼ï¼š`ä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·+æ„å»ºå·`ï¼ˆä¾‹å¦‚ï¼š`1.1.0+1`ï¼‰

#### 1.1 ç¼–è¾‘ `pubspec.yaml`

æ‰“å¼€ `pubspec.yaml` æ–‡ä»¶ï¼Œæ‰¾åˆ° `version` å­—æ®µï¼š

```yaml
version: 1.1.0+1
```

æ ¹æ®å‘å¸ƒç±»å‹æ›´æ–°ç‰ˆæœ¬å·ï¼š
- **ä¸»ç‰ˆæœ¬å·**ï¼ˆ1.x.xï¼‰ï¼šé‡å¤§æ›´æ–°ã€ä¸å…¼å®¹çš„ API å˜æ›´
- **æ¬¡ç‰ˆæœ¬å·**ï¼ˆx.1.xï¼‰ï¼šæ–°åŠŸèƒ½ã€å‘åå…¼å®¹çš„åŠŸèƒ½æ€§æ›´æ–°
- **ä¿®è®¢å·**ï¼ˆx.x.0ï¼‰ï¼šBug ä¿®å¤ã€å°çš„æ”¹è¿›
- **æ„å»ºå·**ï¼ˆ+1ï¼‰ï¼šæ¯æ¬¡æ„å»ºé€’å¢ï¼Œç”¨äºåŒºåˆ†åŒä¸€ç‰ˆæœ¬çš„ä¸åŒæ„å»º

**ç¤ºä¾‹ï¼š**
- ä¿®å¤ Bugï¼š`1.1.0+1` â†’ `1.1.1+1`
- æ–°åŠŸèƒ½ï¼š`1.1.0+1` â†’ `1.2.0+1`
- é‡å¤§æ›´æ–°ï¼š`1.1.0+1` â†’ `2.0.0+1`

#### 1.2 æäº¤ç‰ˆæœ¬å·å˜æ›´

```bash
git add pubspec.yaml
git commit -m "chore: bump version to X.X.X+X"
```

### 2. åˆ›å»º Git Tag

#### 2.1 åˆ›å»ºå¸¦æ³¨é‡Šçš„ Tagï¼ˆæ¨èï¼‰

```bash
# æ ¼å¼ï¼švä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·
git tag -a v1.1.1 -m "Release version 1.1.1"

# æŸ¥çœ‹åˆ›å»ºçš„ tag
git tag -l
```

#### 2.2 æ¨é€ Tag åˆ°è¿œç¨‹ä»“åº“

```bash
# æ¨é€å•ä¸ª tag
git push origin v1.1.1

# æˆ–è€…æ¨é€æ‰€æœ‰ tag
git push origin --tags
```

### 3. æ„å»ºå‘å¸ƒåŒ…

#### 3.1 æ„å»º Android APK

**æ„å»ºå•ä¸ª APKï¼ˆåŒ…å«æ‰€æœ‰æ¶æ„ï¼‰ï¼š**

```bash
flutter build apk --release
```

æ„å»ºå®Œæˆåï¼ŒAPK æ–‡ä»¶ä½äºï¼š`build/app/outputs/flutter-apk/app-release.apk`

**æ„å»ºåˆ†æ¶æ„ APKï¼ˆæ¨èï¼Œæ–‡ä»¶æ›´å°ï¼‰ï¼š**

```bash
flutter build apk --release --split-per-abi
```

æ„å»ºå®Œæˆåï¼ŒAPK æ–‡ä»¶ä½äºï¼š
- `build/app/outputs/flutter-apk/app-armeabi-v7a-release.apk`
- `build/app/outputs/flutter-apk/app-arm64-v8a-release.apk`
- `build/app/outputs/flutter-apk/app-x86_64-release.apk`

#### 3.2 æ„å»º Android App Bundleï¼ˆå¯é€‰ï¼Œç”¨äº Google Playï¼‰

```bash
flutter build appbundle --release
```

æ„å»ºå®Œæˆåï¼ŒAAB æ–‡ä»¶ä½äºï¼š`build/app/outputs/bundle/release/app-release.aab`

### 4. åˆ›å»º GitHub Release

#### 4.1 é€šè¿‡ GitHub Web ç•Œé¢åˆ›å»º

1. è®¿é—® GitHub ä»“åº“é¡µé¢
2. ç‚¹å‡»å³ä¾§ "Releases" â†’ "Draft a new release"
3. é€‰æ‹©åˆšæ‰åˆ›å»ºçš„ tagï¼ˆä¾‹å¦‚ï¼š`v1.1.1`ï¼‰
4. å¡«å†™ Release æ ‡é¢˜ï¼ˆä¾‹å¦‚ï¼š`v1.1.1` æˆ– `Release 1.1.1`ï¼‰
5. åœ¨æè¿°ä¸­å¡«å†™æ›´æ–°å†…å®¹ï¼ˆå¯ä»¥å‚è€ƒ CHANGELOG.mdï¼‰
6. ä¸Šä¼ æ„å»ºå¥½çš„ APK æ–‡ä»¶
7. å‹¾é€‰ "Set as the latest release"ï¼ˆå¦‚æœæ˜¯ä¸»è¦ç‰ˆæœ¬ï¼‰
8. ç‚¹å‡» "Publish release"

#### 4.2 é€šè¿‡ GitHub CLI åˆ›å»ºï¼ˆå¯é€‰ï¼‰

å¦‚æœå®‰è£…äº† GitHub CLIï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºï¼š

```bash
# å®‰è£… GitHub CLIï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
# Windows: winget install GitHub.cli
# macOS: brew install gh
# Linux: å‚è€ƒ https://cli.github.com/manual/installation

# ç™»å½• GitHub CLI
gh auth login

# åˆ›å»º Release
gh release create v1.1.1 \
  --title "v1.1.1" \
  --notes "Release notes here" \
  build/app/outputs/flutter-apk/app-release.apk
```

### 5. éªŒè¯å‘å¸ƒ

å‘å¸ƒå®Œæˆåï¼Œè¯·éªŒè¯ï¼š

1. âœ… GitHub Releases é¡µé¢æ˜¾ç¤ºæ–°ç‰ˆæœ¬
2. âœ… APK æ–‡ä»¶å¯ä»¥æ­£å¸¸ä¸‹è½½
3. âœ… README.md ä¸­çš„ä¸‹è½½é“¾æ¥æŒ‡å‘æœ€æ–°ç‰ˆæœ¬ï¼ˆå¦‚é€‚ç”¨ï¼‰

## ğŸ“ å®Œæ•´å‘å¸ƒå‘½ä»¤ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„å‘å¸ƒæµç¨‹å‘½ä»¤åºåˆ—ï¼ˆä»¥ç‰ˆæœ¬ `1.1.1` ä¸ºä¾‹ï¼‰ï¼š

```bash
# 1. ç¡®ä¿ä»£ç å·²æäº¤
git status

# 2. æ›´æ–°ç‰ˆæœ¬å·ï¼ˆæ‰‹åŠ¨ç¼–è¾‘ pubspec.yaml åï¼‰
git add pubspec.yaml
git commit -m "chore: bump version to 1.1.1+1"

# 3. æ¨é€åˆ°è¿œç¨‹
git push origin main

# 4. åˆ›å»ºå¹¶æ¨é€ tag
git tag -a v1.1.1 -m "Release version 1.1.1"
git push origin v1.1.1

# 5. æ„å»º APK
flutter build apk --release --split-per-abi

# 6. åˆ›å»º GitHub Releaseï¼ˆé€šè¿‡ Web ç•Œé¢æˆ– CLIï¼‰
# ä¸Šä¼  build/app/outputs/flutter-apk/app-*-release.apk æ–‡ä»¶
```

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å›é€€ç‰ˆæœ¬å·ï¼Ÿ

å¦‚æœç‰ˆæœ¬å·æ›´æ–°é”™è¯¯ï¼Œå¯ä»¥ï¼š

```bash
# 1. ä¿®æ”¹ pubspec.yaml ä¸­çš„ç‰ˆæœ¬å·
# 2. æäº¤æ›´æ”¹
git add pubspec.yaml
git commit -m "chore: revert version to X.X.X+X"

# 3. å¦‚æœ tag å·²æ¨é€ï¼Œéœ€è¦åˆ é™¤è¿œç¨‹ tag
git tag -d v1.1.1          # åˆ é™¤æœ¬åœ° tag
git push origin :refs/tags/v1.1.1  # åˆ é™¤è¿œç¨‹ tag
```

### Q: å¦‚ä½•æŸ¥çœ‹æ‰€æœ‰å·²å‘å¸ƒçš„ç‰ˆæœ¬ï¼Ÿ

```bash
# æŸ¥çœ‹æ‰€æœ‰ tag
git tag -l

# æŸ¥çœ‹ tag è¯¦ç»†ä¿¡æ¯
git show v1.1.1
```

### Q: æ„å»ºå¤±è´¥æ€ä¹ˆåŠï¼Ÿ

1. æ¸…ç†æ„å»ºç¼“å­˜ï¼š
   ```bash
   flutter clean
   flutter pub get
   ```

2. æ£€æŸ¥ Flutter ç¯å¢ƒï¼š
   ```bash
   flutter doctor
   ```

3. é‡æ–°è¿è¡Œä»£ç ç”Ÿæˆï¼š
   ```bash
   dart run build_runner build --delete-conflicting-outputs
   ```

## ğŸ“š ç›¸å…³èµ„æº

- [Flutter æ„å»ºå’Œå‘å¸ƒæ–‡æ¡£](https://docs.flutter.dev/deployment/android)
- [Git Tag æ–‡æ¡£](https://git-scm.com/book/en/v2/Git-Basics-Tagging)
- [GitHub Releases æ–‡æ¡£](https://docs.github.com/en/repositories/releasing-projects-on-github)

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç‰ˆæœ¬å·è§„èŒƒ**ï¼šéµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemantic Versioningï¼‰
2. **Tag å‘½å**ï¼šå»ºè®®ä½¿ç”¨ `v` å‰ç¼€ï¼ˆå¦‚ `v1.1.1`ï¼‰
3. **æ„å»ºå‰æ£€æŸ¥**ï¼šç¡®ä¿ä»£ç ç”Ÿæˆå·²å®Œæˆï¼ˆ`dart run build_runner build`ï¼‰
4. **æµ‹è¯•**ï¼šå‘å¸ƒå‰åŠ¡å¿…åœ¨çœŸå®è®¾å¤‡ä¸Šæµ‹è¯• APK
5. **å¤‡ä»½**ï¼šé‡è¦ç‰ˆæœ¬å‘å¸ƒå‰å»ºè®®åˆ›å»ºåˆ†æ”¯å¤‡ä»½

---

**æœ€åæ›´æ–°**ï¼š2025-01-21
